<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <title>Niespodzianka!</title>

    <link rel="stylesheet" href="niespodzianka_style.css" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Amatic+SC:400,700&amp;subset=latin-ext" rel="stylesheet">

    <script type="text/javascript">
        function showDiv()
        {
            document.getElementById("link-block").className = "links";
        }

        window.onload = function ()
        {
            setTimeout(showDiv, 21000);
        };

        function zaladujVoucher()
        {
            var video = document.getElementById("video");
            var linDoVouchera = document.getElementById("link-do-vouchera");

            if (video.ended == true)
            {
                redirectToNamedVoucher();
            }
            else
            {
                linDoVouchera.innerHTML = "Poczekajcie do końca :)";
            }
        }

        function zmienOpisLinkaNaKoniecVideo()
        {
            var linDoVouchera = document.getElementById("link-do-vouchera");
            linDoVouchera.innerHTML = "Teraz można odebrać nagrodę :)";
        }

        var GRUDZIEN = "Grudzień";
        var GRUDNIOWIE = "Grudniowie";
        var GRUDZ_HASLO = "adamsy";

        var STAWIARZ = "Stawiarz";
        var STAWIARZOWIE = "Stawiarzowie";
        var STAW_HASLO = "kombi";

        function redirectToNamedVoucher()
        {
            var parentsLastName = prompt("Podajcie proszę Wasze nazwisko. Wzór poniżej:", "Kowalscy");
            var password;

            while (parentsLastName != GRUDZIEN && parentsLastName != GRUDNIOWIE
                    && parentsLastName != STAWIARZ && parentsLastName != STAWIARZOWIE)
            {
                if (parentsLastName != null &&
                        (parentsLastName == "Grudzien" || parentsLastName == "grudzien" ||
                            parentsLastName == "grudniowie"))
                {
                    if (parentsLastName == "Grudzien")
                    {
                        alert("Chyba brakło ogonka nad 'n' :)");
                        parentsLastName = prompt("Podajcie proszę Wasze nazwisko. Wzór poniżej:", "Kowalscy");
                    }
                    else if (parentsLastName == "grudzien" || parentsLastName == "grudniowie")
                    {
                        alert("Nazwisko zaczynamy od DUŻEJ litery :)");
                        parentsLastName = prompt("Podajcie proszę Wasze nazwisko. Wzór poniżej:", "Kowalscy");
                    }
                }
                else if (parentsLastName != null &&
                            (parentsLastName == "stawiarz" || parentsLastName == "stawiarzowie"))
                {
                    alert("Nazwisko zaczynamy od DUŻEJ litery :)");
                    parentsLastName = prompt("Podajcie proszę Wasze nazwisko. Wzór poniżej:", "Kowalscy");
                }
                else if (parentsLastName == null || parentsLastName == "")
                {
                    alert("Nazwisko puste bądź kliknięto przycisk 'Anuluj'");
                    parentsLastName = prompt("Podajcie proszę Wasze nazwisko. Wzór poniżej:", "Kowalscy");
                }
                else
                {
                    alert("Czemu kłamiecie? :D");
                    parentsLastName = prompt("Podajcie proszę Wasze nazwisko. Wzór poniżej:", "Kowalscy");
                }
            }

            do
            {
                password = prompt("Hasełko z listu:");

                if (password != null)
                {
                    if (!checkMatch(parentsLastName, password))
                    {
                        alert("Nieprawidłowe hasło :)")
                    }
                }
                else
                {
                    alert("Hasełko puste bądź kliknięto przycisk 'Anuluj'");
                    password = prompt("Hasełko z listu:");
                }
            }
            while (!checkMatch(parentsLastName, password));
        }

        function checkMatch(parentsLastName, password)
        {
            if (parentsLastName == GRUDZIEN && password == GRUDZ_HASLO)
            {
                window.location.href = "voucher-viola-franus.html";
                return true;
            }
            else if (parentsLastName == GRUDNIOWIE && password == GRUDZ_HASLO)
            {
                window.location.href = "voucher-viola-franus.html";
                return true;
            }
            else if (parentsLastName == STAWIARZ && password == STAW_HASLO)
            {
                window.location.href = "voucher-asia-stasiu.html";
                return true;
            }
            else if (parentsLastName == STAWIARZOWIE && password == STAW_HASLO)
            {
                window.location.href = "voucher-asia-stasiu.html";
                return true;
            }
            else
            {
                return false;
            }
        }
    </script>
</head>
<body class="animate-in">
    <div id="container">
        <div id="movie-2-div">
            <video id="video" autoplay onended="zmienOpisLinkaNaKoniecVideo()">
                <source src="movie-2.mp4" type="video/mp4">
            </video>
        </div>
        <div id="link-block" class="hide">
            <a id="link-do-vouchera" onclick="zaladujVoucher()">Tutaj można odebrać nagrodę :)</a>
        </div>
    </div>
    <script type="text/javascript">
        window.addEventListener("beforeunload", function ()
        {
            document.body.classList.add("animate-out");
        })
    </script>
</body>
</html>